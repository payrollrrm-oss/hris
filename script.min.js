// Minified version of script.js
const SCRIPT_URL=CONFIG.SCRIPT_URL;let currentUser=null;function showLoading(){document.getElementById('loadingScreen').style.display='flex'}function hideLoading(){document.getElementById('loadingScreen').style.display='none'}function showLogin(){document.getElementById('loginScreen').style.display='flex';document.getElementById('mainApp').style.display='none'}function showMainApp(){document.getElementById('loginScreen').style.display='none';document.getElementById('mainApp').style.display='block'}async function login(){const email=document.getElementById('emailInput').value.trim();if(!email){alert('Masukkan email');return}showLoading();try{const response=await fetch(`${SCRIPT_URL}?action=login&email=${encodeURIComponent(email)}`);const data=await response.json();if(data.success){currentUser=data.user;localStorage.setItem('hrisUser',JSON.stringify(currentUser));showMainApp();loadDashboard();renderMenu();}else{alert(data.message||'Login gagal')}}catch(error){console.error('Login error:',error);alert('Terjadi kesalahan saat login')}finally{hideLoading()}}function logout(){currentUser=null;localStorage.removeItem('hrisUser');showLogin()}function renderMenu(){const menuContainer=document.getElementById('menuContainer');if(!currentUser)return;const isAdmin=currentUser.role==='admin';const menuItems=isAdmin?[{id:'dashboard',name:'Dashboard',icon:'fas fa-tachometer-alt'},{id:'employees',name:'Data Karyawan',icon:'fas fa-users'},{id:'attendance',name:'Absensi',icon:'fas fa-clock'},{id:'k3',name:'Laporan K3',icon:'fas fa-exclamation-triangle'},{id:'mcu',name:'Permohonan MCU',icon:'fas fa-stethoscope'},{id:'apd',name:'Permintaan APD',icon:'fas fa-hard-hat'},{id:'reports',name:'Laporan',icon:'fas fa-chart-bar'}]:[{id:'dashboard',name:'Dashboard',icon:'fas fa-tachometer-alt'},{id:'attendance',name:'Absensi',icon:'fas fa-clock'},{id:'k3',name:'Laporan K3',icon:'fas fa-exclamation-triangle'},{id:'mcu',name:'Permohonan MCU',icon:'fas fa-stethoscope'},{id:'apd',name:'Permintaan APD',icon:'fas fa-hard-hat'}];menuContainer.innerHTML=menuItems.map(item=>`<div class="menu-item" onclick="loadModule('${item.id}')"><i class="${item.icon}"></i><span>${item.name}</span></div>`).join('')}function loadModule(moduleId){const contentArea=document.getElementById('contentArea');switch(moduleId){case'dashboard':loadDashboard();break;case'employees':loadEmployees();break;case'attendance':loadAttendance();break;case'k3':loadK3Reports();break;case'mcu':loadMcuRequests();break;case'apd':loadApdRequests();break;case'reports':loadReports();break;default:contentArea.innerHTML='<div class="alert alert-warning">Modul tidak ditemukan</div>'}}function checkAuth(){const savedUser=localStorage.getItem('hrisUser');if(savedUser){try{currentUser=JSON.parse(savedUser);showMainApp();loadDashboard();renderMenu();}catch(error){console.error('Error parsing saved user:',error);localStorage.removeItem('hrisUser');showLogin()}}else{showLogin()}}document.addEventListener('DOMContentLoaded',function(){checkAuth()});
